package com.optimove.sdk.optimove_sdk.events_tests;

import com.optimove.sdk.optimove_sdk.main.events.core_events.AppOpenEvent;

import org.junit.Assert;
import org.junit.Test;

import java.util.Map;

public class AppOpenTests {


    @Test
    public void appOpenShouldContainTheRightName(){
        String userId = "user_id";
        String visitorId = "visitor_id";
        String fullPackageName = "full_package_name";
        String encryptedDeviceId = "encrypted_device_id";

        AppOpenEvent appOpenEvent = new AppOpenEvent(userId,visitorId,fullPackageName,encryptedDeviceId);
        Assert.assertEquals(AppOpenEvent.EVENT_NAME,appOpenEvent.getName());
    }
    @Test
    public void appOpenShouldContainRightPackageAndDeviceIdParams(){
        String userId = "user_id";
        String visitorId = "visitor_id";
        String fullPackageName = "full_package_name";
        String encryptedDeviceId = "encrypted_device_id";

        AppOpenEvent appOpenEvent = new AppOpenEvent(userId,visitorId,fullPackageName,encryptedDeviceId);
        Map<String, Object> parameters = appOpenEvent.getParameters();

        Assert.assertEquals(parameters.get(AppOpenEvent.APP_NS_PARAM_KEY),fullPackageName);
        Assert.assertEquals(parameters.get(AppOpenEvent.DEVICE_ID_PARAM_KEY),encryptedDeviceId);
    }
    @Test
    public void appOpenShouldContainOnlyUserIdParamIfExists(){
        String userId = "user_id";
        String visitorId = "visitor_id";
        String fullPackageName = "full_package_name";
        String encryptedDeviceId = "encrypted_device_id";

        AppOpenEvent appOpenEvent = new AppOpenEvent(userId,visitorId,fullPackageName,encryptedDeviceId);
        Map<String, Object> parameters = appOpenEvent.getParameters();

        Assert.assertEquals(parameters.get(AppOpenEvent.USER_ID_PARAM_KEY_),userId);
        Assert.assertFalse(parameters.containsKey(AppOpenEvent.VISITOR_ID_PARAM_KEY));
    }
    @Test
    public void appOpenShouldContainOnlyVisitorIdIfUserAbsent(){
        String visitorId = "visitor_id";
        String fullPackageName = "full_package_name";
        String encryptedDeviceId = "encrypted_device_id";

        AppOpenEvent appOpenEvent = new AppOpenEvent(null,visitorId,fullPackageName,encryptedDeviceId);
        Map<String, Object> parameters = appOpenEvent.getParameters();

        Assert.assertEquals(parameters.get(AppOpenEvent.VISITOR_ID_PARAM_KEY),visitorId);
        Assert.assertFalse(parameters.containsKey(AppOpenEvent.USER_ID_PARAM_KEY_));
    }
}
